 .gitignore                                         |   11 +
 TKNP/README.md                                     |  179 ++++
 TKNP/archive/analyze_results.py                    |  262 +++++
 TKNP/archive/batch_inference.py                    |   79 ++
 TKNP/archive/design.md                             |   27 +
 TKNP/archive/run_experiment.py                     |   56 ++
 TKNP/batch_exp/README_batch_inference.md           |  358 +++++++
 TKNP/batch_exp/batch_inference_experiment.py       |  531 ++++++++++
 .../batch_inference_results.json                   |  434 ++++++++
 .../batch_exp/experiment_results/tp_1_results.json |  434 ++++++++
 TKNP/batch_exp/run_batch_experiments.sh            |  259 +++++
 TKNP/benchmark_inference.py                        |  327 ++++++
 TKNP/design.md                                     |   87 ++
 TKNP/docker_help.md                                |  104 ++
 TKNP/implementation/bench_one_to_many.py           |  490 +++++++++
 TKNP/implementation/disaggregated_plan.md          |  725 ++++++++++++++
 TKNP/implementation/distributed_plan.md            |  570 +++++++++++
 TKNP/implementation/implementation_plan.md         |  242 +++++
 TKNP/implementation/summary.md                     |  409 ++++++++
 .../token_parallel_integration_summary.md          |  162 +++
 TKNP/model_test.py                                 |  174 ++++
 TKNP/prompt_generator.py                           |  414 ++++++++
 TKNP/prototype/run_hamp_datacollection.sh          |  120 +++
 TKNP/prototype/run_hamp_tests.sh                   |   69 ++
 TKNP/prototype/run_tp_flashattention.sh            |   58 ++
 TKNP/prototype/test_hamp_attention.py              |  346 +++++++
 TKNP/prototype/tknp_attention.py                   | 1040 ++++++++++++++++++++
 TKNP/run_tknp_datacollection.sh                    |  120 +++
 TKNP/run_tknp_tests.sh                             |   67 ++
 .../http_tests_4789074_NODES_2.err                 |  322 ++++++
 .../http_tests_4789074_NODES_2.out                 |  128 +++
 .../http_tests_4789411_NODES_1.err                 |  161 +++
 .../http_tests_4789411_NODES_1.out                 |   64 ++
 .../http_tests_4790596_NODES_1.err                 |   20 +
 .../http_tests_4790596_NODES_1.out                 |  161 +++
 .../http_tests_4791071_NODES_2.err                 |  322 ++++++
 .../http_tests_4791071_NODES_2.out                 |  128 +++
 .../http_tests_4791126_NODES_2.err                 |   56 ++
 .../http_tests_4791126_NODES_2.out                 |  655 ++++++++++++
 TKNP/start_vllm_container.sh                       |   14 +
 TKNP/test_TKNP_classes.py                          |  281 ++++++
 TKNP/test_dist_ranks.py                            |  159 +++
 TKNP/test_prefix_caching.py                        |  168 ++++
 TKNP/test_process_groups_only.py                   |  179 ++++
 TKNP/test_sparse_llama.py                          |   27 +
 TKNP/test_torchrun.py                              |  145 +++
 TKNP/test_worker_ranks.py                          |   64 ++
 TKNP/tknp_inference_benchmarks.py                  |  206 ++++
 vllm/config.py                                     |   38 +-
 vllm/distributed/parallel_state.py                 |  186 +++-
 vllm/engine/arg_utils.py                           |   29 +
 vllm/forward_context.py                            |   28 +
 .../model_executor/layers/token_parallel_linear.py |  554 +++++++++++
 vllm/model_executor/models/llama.py                |  117 ++-
 vllm/model_executor/models/llama_og.py             |  652 ++++++++++++
 vllm/model_executor/models/llama_sparse.py         |  700 +++++++++++++
 vllm/model_executor/models/llama_vllm.py           |  647 ++++++++++++
 vllm/model_executor/models/og_llama.py             |  647 ++++++++++++
 vllm/transformers_utils/configs/ovis.py            |    2 +-
 vllm/v1/core/kv_cache_coordinator.py               |    9 +-
 vllm/v1/core/kv_cache_manager.py                   |   21 +-
 vllm/v1/core/sched/output.py                       |   12 +
 vllm/v1/core/sched/scheduler.py                    |  296 +++++-
 vllm/v1/executor/abstract.py                       |    5 +-
 vllm/v1/worker/gpu_model_runner.py                 |  447 ++++++++-
 vllm/v1/worker/gpu_worker.py                       |   24 +-
 66 files changed, 15762 insertions(+), 66 deletions(-)
